<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>hotrstuff • hotrstuff</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="hotrstuff">
<meta property="og:description" content="hotrstuff">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hotrstuff</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/hotrstuff.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>hotrstuff</h1>
            
      
      
      <div class="hidden name"><code>hotrstuff.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library(hotrstuff)</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Loading <span style="color: #0000BB;">hotrstuff</span></span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.7.71</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'terra'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:testthat':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     compare, describe</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; here() starts at /Users/eve067/GitHub/hotrstuff</span></span></code></pre></div>
<p>This vignette shows how you can download, wrangle, and process ESM
data to calculate climate metrics. The idea is that the functions are
independent of each other and can still perform their purpose without
having to follow the entire workflow detailed below, from start to
finish.</p>
<p>This code works for both monthly (<code>mon</code>) and daily
(<code>day</code>) climate data.</p>
<p>I would recommend creating a <code>data</code> folder, with the
following basic structure:</p>
<ul>
<li>
<code>data/raw/</code>: raw, untouched data</li>
<li>
<code>data/raw/wget</code>: downloaded <code>wget</code>
scripts</li>
<li>
<code>data/raw/tos</code>: raw ESM data (e.g., tos - sea surface
temperature)</li>
<li>
<code>data/proc/</code>: processed ESM data</li>
<li>
<code>data/proc/merged</code>: merged files per model - 1 model per
model/variable/scenario/frequency combination</li>
<li>
<code>data/proc/sliced</code>: sliced files depending on the
required time period</li>
<li>
<code>data/proc/yearly</code>: yearly data (after converting monthly
frequency to yearly frequency)</li>
<li>
<code>data/proc/regridded</code>: regridded data, standardizing
grids of data</li>
<li>
<code>data/proc/ensemble</code>: ensemble mean/median for each
variable/scenario/frequency combination</li>
</ul>
<p>We will follow this folder structure throughout the vignette. It will
still work with a different folder structure, just make sure you’re
inputting the right paths.</p>
<div class="section level2">
<h2 id="downloading-esm-outputs">Downloading ESM outputs<a class="anchor" aria-label="anchor" href="#downloading-esm-outputs"></a>
</h2>
<p>To download ESMs, you’d still have to download the <code>wget</code>
scripts from your chosen CMIP6 repository. I would suggest using: <a href="https://aims2.llnl.gov/search" class="external-link uri">https://aims2.llnl.gov/search</a>.</p>
<p>If you want to follow along, use the wget scripts that are in the
<code>data/raw/wget</code> folder. But, you can use other
<code>wget</code> scripts; just make sure to change the arguments.</p>
<p>Then, run the <code>download_ESM</code> function to run all the
<code>wget</code> scripts found in that folder.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base_dir</span> <span class="op">&lt;-</span> <span class="st">"."</span> <span class="co"># Just start relative to this location</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htr_make_folder.html">htr_make_folder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"raw"</span>, <span class="st">"tos"</span><span class="op">)</span><span class="op">)</span> <span class="co"># make folder</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htr_download_ESM.html">htr_download_ESM</a></span><span class="op">(</span></span>
<span>  indir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"raw"</span>, <span class="st">"wget"</span><span class="op">)</span>, <span class="co"># input directory</span></span>
<span>  outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"raw"</span>, <span class="st">"tos"</span><span class="op">)</span> <span class="co"># output directory</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="merging-files">Merging files<a class="anchor" aria-label="anchor" href="#merging-files"></a>
</h2>
<p>We now merge files by model-variable-scenario-frequency
combination.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/htr_make_folder.html">htr_make_folder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"merged"</span>, <span class="st">"tos"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htr_merge_files.html">htr_merge_files</a></span><span class="op">(</span>indir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"raw"</span>, <span class="st">"tos"</span><span class="op">)</span>, <span class="co">#input directory</span></span>
<span>                outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"merged"</span>, <span class="st">"tos"</span><span class="op">)</span>, <span class="co">#output directory</span></span>
<span>                year_start <span class="op">=</span> <span class="fl">1985</span>, <span class="co"># earliest year across all the scenarios considered (e.g., historical, ssp126, ssp245, ssp585)</span></span>
<span>                year_end <span class="op">=</span> <span class="fl">2100</span> <span class="co"># latest year across all the scenarios considered</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>So this would result in just 1 <code>.nc</code> file for each
model-variable-scenario-frequency combination.</p>
</div>
<div class="section level2">
<h2 id="adjust-and-reframe-time-periods">Adjust and reframe time periods<a class="anchor" aria-label="anchor" href="#adjust-and-reframe-time-periods"></a>
</h2>
<p>We now want to only keep the years we’re interested in. For example,
we want to make sure that for future projections, we only want to look
at 2020-2100.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/htr_make_folder.html">htr_make_folder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"sliced"</span>, <span class="st">"tos"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htr_slice_period.html">htr_slice_period</a></span><span class="op">(</span>indir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"merged"</span>, <span class="st">"tos"</span><span class="op">)</span>, <span class="co">#input directory</span></span>
<span>                 outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"sliced"</span>, <span class="st">"tos"</span><span class="op">)</span>, <span class="co">#output directory</span></span>
<span>                 frq <span class="op">=</span> <span class="st">"Omon"</span>, <span class="co">#ocean, daily</span></span>
<span>                 scenario <span class="op">=</span> <span class="st">"ssp"</span>,</span>
<span>                 year_start <span class="op">=</span> <span class="fl">2020</span>,</span>
<span>                 year_end <span class="op">=</span> <span class="fl">2100</span>,</span>
<span>                 overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ACCESS-ESM1-5_ssp126"</span></span>
<span><span class="co">#&gt; [1] "CanESM5_ssp126"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fix-calendar-periods-if-needed">Fix calendar periods (if needed)<a class="anchor" aria-label="anchor" href="#fix-calendar-periods-if-needed"></a>
</h2>
<p>This function fixes the calendar days, for days with leap years. This
is to standardize the calendar across the different models.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/htr_fix_calendar.html">htr_fix_calendar</a></span><span class="op">(</span>indir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"sliced"</span>, <span class="st">"tos"</span><span class="op">)</span><span class="op">)</span> <span class="co">#will be rewritten</span></span>
<span><span class="co">#&gt; tos_Omon_ACCESS-ESM1-5_ssp126_r1i1p1f1_merged_20200101-21001231.nc does not have leap days</span></span>
<span><span class="co">#&gt; tos_Omon_CanESM5_ssp126_r1i1p1f1_merged_20200101-21001231.nc does not have leap days</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="changing-frequency-of-climate-data">Changing frequency of climate data<a class="anchor" aria-label="anchor" href="#changing-frequency-of-climate-data"></a>
</h2>
<p>I created two functions: i) changes frequency to monthly
(<code>monthly_frequency()</code>), and ii) changes frequency to yearly
(<code>yearly_frequency()</code>), but because I’ve started with monthly
data here, I didn’t run <code>monthly_frequency()</code> here (but it
works).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/htr_make_folder.html">htr_make_folder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"monthly"</span>, <span class="st">"tos"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htr_change_freq.html">htr_change_freq</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="st">"monthly"</span>,</span>
<span>                indir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"sliced"</span>, <span class="st">"tos"</span><span class="op">)</span>, <span class="co">#input directory</span></span>
<span>                outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"yearly"</span>, <span class="st">"tos"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Uncomment the code above if you’re using daily data and changing it
to a monthly frequency.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/htr_make_folder.html">htr_make_folder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"yearly"</span>, <span class="st">"tos"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htr_change_freq.html">htr_change_freq</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="st">"yearly"</span>,</span>
<span>                indir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"sliced"</span>, <span class="st">"tos"</span><span class="op">)</span>, <span class="co">#input directory</span></span>
<span>                outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"yearly"</span>, <span class="st">"tos"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This should create a new file that has a yearly frequency. For the
rest of the analyses, I’ll only continue with the yearly data.</p>
</div>
<div class="section level2">
<h2 id="regridding">Regridding<a class="anchor" aria-label="anchor" href="#regridding"></a>
</h2>
<p>The climate models have different grids, so now we need to regrid and
standardize the grid. This requires a base, empty raster that will be
made automatically in the <code>regrid_esm()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/htr_make_folder.html">htr_make_folder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"raw"</span>, <span class="st">"base_raster"</span><span class="op">)</span><span class="op">)</span> <span class="co">#create folder for base raster</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htr_make_folder.html">htr_make_folder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"regridded"</span>, <span class="st">"yearly"</span>, <span class="st">"tos"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htr_regrid_esm.html">htr_regrid_esm</a></span><span class="op">(</span>indir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"yearly"</span>, <span class="st">"tos"</span><span class="op">)</span>,</span>
<span>               outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"regridded"</span>, <span class="st">"yearly"</span>, <span class="st">"tos"</span><span class="op">)</span>,</span>
<span>               blankrast_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"raw"</span>, <span class="st">"base_raster"</span><span class="op">)</span>,</span>
<span>               cell_res <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>               layer <span class="op">=</span> <span class="st">"annual"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ACCESS-ESM1-5 ssp126"</span></span>
<span><span class="co">#&gt; [1] "CanESM5 ssp126"</span></span></code></pre></div>
<p>Let’s try to plot this. Just plotting for the first time point and
for the two models.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "/Users/eve067/GitHub/hotrstuff/vignettes"</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"regridded"</span>, <span class="st">"yearly"</span>, <span class="st">"tos"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">models</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model1</span><span class="op">$</span><span class="va">tos_1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hotrstuff_files/figure-html/plot_regridded-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">models</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model2</span><span class="op">$</span><span class="va">tos_1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hotrstuff_files/figure-html/plot_regridded-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="create-ensemble">Create ensemble<a class="anchor" aria-label="anchor" href="#create-ensemble"></a>
</h2>
<p>For now, we only have 2 models, but if you have more models, you just
need to input a list of the model names as a vector in the
<code>model_list</code> argument.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/htr_make_folder.html">htr_make_folder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"ensemble"</span>, <span class="st">"mean"</span>, <span class="st">"tos"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htr_create_ensemble.html">htr_create_ensemble</a></span><span class="op">(</span>indir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"regridded"</span>, <span class="st">"yearly"</span>, <span class="st">"tos"</span><span class="op">)</span>, <span class="co">#input directory</span></span>
<span>                    outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"ensemble"</span>, <span class="st">"mean"</span>, <span class="st">"tos"</span><span class="op">)</span>, <span class="co">#output directory</span></span>
<span>                    model_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACCESS-ESM1-5"</span>, <span class="st">"CanESM5"</span><span class="op">)</span>, <span class="co">#list of models for ensemble</span></span>
<span>                    variable <span class="op">=</span> <span class="st">"tos"</span>, <span class="co">#variable name</span></span>
<span>                    frequency <span class="op">=</span> <span class="st">"Omon"</span>, <span class="co">#original frequency of data</span></span>
<span>                    scenario <span class="op">=</span> <span class="st">"ssp126"</span>, <span class="co">#emission scenario</span></span>
<span>                    mean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># if false, takes the median</span></span></code></pre></div>
<p>Then, we plot to see how it looks.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ensemble_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_dir</span>, <span class="st">"data"</span>, <span class="st">"proc"</span>, <span class="st">"ensemble"</span>, <span class="st">"mean"</span>, <span class="st">"tos"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ensemble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">ensemble_model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ensemble</span><span class="op">$</span><span class="va">tos_1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hotrstuff_files/figure-html/plot_ensemble-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kristine (Tin) C. Buenafe, David Schoeman, Jason D. Everett.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
